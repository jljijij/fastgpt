 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/projects/app/Dockerfile b/projects/app/Dockerfile
index 5142d120798f50cf42d4728875c3be2f90cc025d..10d56047c7881156c7828adc784204d526ea0e07 100644
--- a/projects/app/Dockerfile
+++ b/projects/app/Dockerfile
@@ -50,48 +50,51 @@ WORKDIR /app
 ARG proxy
 ARG base_url
 
 # create user and use it
 RUN addgroup --system --gid 1001 nodejs
 RUN adduser --system --uid 1001 nextjs
 
 RUN [ -z "$proxy" ] || sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories
 RUN apk add --no-cache curl ca-certificates \
   && update-ca-certificates
 
 # copy running files
 COPY --from=builder /app/projects/app/public /app/projects/app/public
 COPY --from=builder /app/projects/app/next.config.js /app/projects/app/next.config.js
 COPY --from=builder --chown=nextjs:nodejs /app/projects/app/.next/standalone /app/
 COPY --from=builder --chown=nextjs:nodejs /app/projects/app/.next/static /app/projects/app/.next/static
 # copy server chunks
 COPY --from=builder --chown=nextjs:nodejs /app/projects/app/.next/server/chunks /app/projects/app/.next/server/chunks
 # copy worker
 COPY --from=builder --chown=nextjs:nodejs /app/projects/app/.next/server/worker /app/projects/app/.next/server/worker
 
 # copy standload packages
 COPY --from=maindeps /app/node_modules/tiktoken ./node_modules/tiktoken
 RUN rm -rf ./node_modules/tiktoken/encoders
 COPY --from=maindeps /app/node_modules/@zilliz/milvus2-sdk-node ./node_modules/@zilliz/milvus2-sdk-node
+RUN mkdir -p projects/app/.next/proto \
+  && cp -r node_modules/@zilliz/milvus2-sdk-node/dist/proto/proto \
+         projects/app/.next/proto/
 
 
 # copy package.json to version file
-COPY --from=builder /app/projects/app/package.json ./package.json 
+COPY --from=builder /app/projects/app/package.json ./package.json
 
 # copy config
 COPY ./projects/app/data /app/data
 RUN chown -R nextjs:nodejs /app/data
 
 # Add tmp directory permission control
 
 ENV NODE_ENV=production
 ENV NEXT_TELEMETRY_DISABLED=1
 ENV PORT=3000
 ENV NEXT_PUBLIC_BASE_URL=$base_url
 
 EXPOSE 3000
 
 USER nextjs
 
 ENV serverPath=./projects/app/server.js
 
 ENTRYPOINT ["sh","-c","node --max-old-space-size=4096 ${serverPath}"]
\ No newline at end of file
 
EOF
)